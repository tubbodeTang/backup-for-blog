---
title: Echarts 之复合饼图的解决方案
date: 2018-05-22 22:39:01
tags: Echarts
categories: Javascript
---

>Echarts 是百度出品的功能强大的开源可视化库，由 Javascript 实现。
>具有丰富的可视化类型，良好的跨平台特性，绚丽的视觉效果。
>是大数据分析展示的有力武器
  

 
老实说其实在我刚进入前端开发这个领域的时候就听说并使用了 Echarts ，那个时候还是 1.0 版本。

最开始只是用到一些简单的条、饼、线图的组合展示，有时候我还会偷懒直接使用 [图说](http://tushuo.baidu.com/) 的可视化功能进行操作，也还挺方便的，不用记那么多属性，但是现在 [图说](http://tushuo.baidu.com/) 已经满足不了我更高级的需求了，有什么问题还是看文档更清晰。


一直到今天，Echarts 已经出了 4.0 版本，功能和性能都有了非常的大的提升，也正因为这样，使用 Echarts 的人越来越多，Echarts 的社区也越来越活跃，活跃的社区又会促进 Echarts 生生不息的向前发展，形成一个良性循环。我想，这就是开源的魅力吧。

最近在工作当中使用 Echarts 来深度挖掘和展示我手头的数据，发现有一个地方可能需要复合饼图来展示效果比较好。

看了很多官方的实例，没有特别称手能直接拿来用的。GitHub 上 Echarts 的 Issues 区我也去搜了，看有没有人已经踩过坑。结果发现一天前，就有人提了一个和我一模一样的情景，问有没有用复合图来实现的方案，他也不知道怎么解决。

哈哈，结果还是要靠自己了。

于是乎看了一些 Echarts Gallery 上大家的奇思妙想之后，我也有了灵感。

（这里穿插说一句，Echarts 升级之后社区真的变强了很多，不仅有很清晰的官方文档和实例，Gallery 里各方大神的脑洞也真的很精彩，比如我就看见过用 Echarts 做动画的，Flappy Bird，扫雷，还有一些酷炫的 3D 效果我就不说了，一打开那界面电脑风扇都开始呜呜响，哈哈，留待给以后慢慢发掘，有空专门再写一个收集贴。）

#### 方案一
第一个方案是想画两个饼图，再用 series->type:graph 这个属性画两根线把两个饼图连起来。

尝试了多次，发现不能通过点坐标的调整得到线的正确位置。我想要的是直角坐标，所以从直角坐标的角度看来，线的中心点是固定的，一直在 (0，0) ，不能上下左右移动。也就是说 y=kx+b 的 b 一直都是 0，只有线的斜率一直在变化，所以我判断那个坐标有可能是极坐标，所以才没有办法按直角坐标得到正确的结果。

而且使用这种方式还有一个弊端，就是两个饼图连接点的坐标，其实不那么好确定，因为有可能随着百分比的变化而变化。所以最终，我放弃了这个方案。

#### 方案二

换一个思路，采用之前在 Gallery 中看见过的环状图套饼图来实现。

我看见过用透明环状饼区来占位的，这样看起来透明饼区就不存在了，只能看到不透明的饼区，刚好可以用来做展开的详细复合图。

于是乎有了下面这个效果，具体代码实现和结果可以到 Gallery 里 [查看](http://gallery.echartsjs.com/editor.html?c=xHJaWqD-1Q)。

![实现效果缩略图](http://echarts.baidu.com/ecg-storage/img/xHJaWqD-1Q.png "实现效果缩略图")


两个版本的思路出来效果之后，我都给了 GitHub Issues 上和我相同问题的那个哥们一个回复，他也回复了我，和大家一起思考问题的感觉还是很棒的。

我发表在 Gallery 里的 [示例](http://gallery.echartsjs.com/editor.html?c=xHJaWqD-1Q)，截至目前也已经有了二十多次的浏览量。

这就是分享的力量，它不仅帮助别人，同时也在激励监督自己，让自己做的更好。

这是我第一次体验到分享的乐趣，所以记录下来，鞭策自己以后更加努力！
